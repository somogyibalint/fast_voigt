use num_traits::Float;

pub const SQRT2PI: f64 = 2.5066282746310002; // √(2π)
pub const RSQRTPI: f64 = 0.5641895835477563; // 1.0 / √π 

pub const L16: f64 = 3.3635856610148585;  // sqrt(N)/2^(1/4)
pub const L24: f64 = 4.1195342878142354;  // sqrt(N)/2^(1/4)
pub const L32: f64 = 4.7568284600108843;  // sqrt(N)/2^(1/4)
pub const L16S: f32 = L16 as f32;

pub const W16S: [f32; 16] = [
    9.9393225361232851e-07, 3.9812875760042709e-06, -5.5842334104101195e-06, -2.7346404624048783e-05,
    2.1709867932466571e-05, 2.1071056396581287e-04, 8.7031584284902146e-05, -1.5276597401218833e-03,
    -3.8810151890227547e-03, 3.6825673170924143e-03, 5.1822402431611909e-02, 1.9124172674669498e-01,
    4.6929090090360348e-01, 8.8644783020505524e-01, 1.3622408222719591e+00, 1.7483958860819617e+00];

pub const W16: [f64; 16] = [
    9.9393225361232851e-07, 3.9812875760042709e-06, -5.5842334104101195e-06, -2.7346404624048783e-05,
    2.1709867932466571e-05, 2.1071056396581287e-04, 8.7031584284902146e-05, -1.5276597401218833e-03,
    -3.8810151890227547e-03, 3.6825673170924143e-03, 5.1822402431611909e-02, 1.9124172674669498e-01,
    4.6929090090360348e-01, 8.8644783020505524e-01, 1.3622408222719591e+00, 1.7483958860819617e+00];

pub const W24: [f64; 24] = [
    -1.5137461654527820e-10, 4.9048215867870488e-09, 1.3310461806370372e-09, -3.0082822811202271e-08,
    -1.9122258522976932e-08, 1.8738343486619108e-07, 2.5682641346701115e-07, -1.0856475790698251e-06,
    -3.0388931839840047e-06, 4.1394617248575527e-06, 3.0471066083243790e-05, 2.4331415462641969e-05,
    -2.0748431511424456e-04, -7.8166429956142650e-04, -4.9364269012806686e-04, 6.2150063629501763e-03,
    3.3723366855316413e-02, 1.0838723484566792e-01, 2.6549639598807689e-01, 5.3611395357291292e-01,
    9.2570871385886788e-01, 1.3948196733791203e+00, 1.8562864992055408e+00, 2.1978589365315417e+00];

pub const W32: [f64; 32] = [
    -1.3031797863050087e-12, 3.7424975634801558e-12, 8.0314997274316680e-12, -2.1542618451370239e-11,
    -5.5441820344468828e-11, 1.1658312885903929e-10, 4.1537465934749353e-10, -5.2310170266050247e-10,
    -3.2080150458594088e-09, 8.1248960947953431e-10, 2.3797557105844622e-08, 2.2930439569075392e-08,
    -1.4813078891201116e-07, -4.1840763666294341e-07, 4.2558331390536872e-07, 4.4015317319048931e-06,
    6.8210319440412389e-06, -2.1409619200870880e-05, -1.3075449254548613e-04, -2.4532980269928922e-04,
    3.9259136070122748e-04, 4.5195411053501429e-03, 1.9006155784845689e-02, 5.7304403529837900e-02,
    1.4060716226893769e-01, 2.9544451071508926e-01, 5.4601397206393498e-01, 9.0192548936480144e-01,
    1.3455441692345453e+00, 1.8256696296324824e+00, 2.2635372999002676e+00, 2.5722534081245696e+00];


pub struct WeidemanParams<T> where 
T: Float + 'static {
    pub coef: &'static [T],
    pub l: T
} 
pub const WP16S: WeidemanParams<f32> = WeidemanParams {
    coef: &W16S,
    l: L16 as f32
}; 

pub const WP16: WeidemanParams<f64> = WeidemanParams {
    coef: &W16,
    l: L16
}; 
pub const WP24: WeidemanParams<f64> = WeidemanParams {
    coef: &W24,
    l: L24
};
pub const WP32: WeidemanParams<f64> = WeidemanParams {
    coef: &W32,
    l: L32
};


pub(crate) trait VoigtConstants {
    const ZERO: Self;
    const ONE: Self;
    const TWO: Self;
    const FOUR: Self;
    const PI: Self;
    const SQRT2PI: Self;
    const RSQRTPI: Self;
    const SQRT2: Self; 
}

impl VoigtConstants for f32 {
    const ZERO: Self = 0f32;
    const ONE: Self = 1f32;
    const TWO: Self = 2f32;
    const FOUR: Self = 4f32;
    const PI: Self = std::f32::consts::PI;
    const SQRT2PI: Self = 2.5066282746310002;
    const RSQRTPI: Self = 0.5641895835477563;
    const SQRT2: Self = std::f32::consts::SQRT_2; 
}

impl VoigtConstants for f64 {
    const ZERO: Self = 0f64;
    const ONE: Self = 1f64;
    const TWO: Self = 2f64;
    const FOUR: Self = 4f64;
    const PI: Self = std::f64::consts::PI;
    const SQRT2PI: Self = 2.5066282746310002;
    const RSQRTPI: Self = 0.5641895835477563;
    const SQRT2: Self = std::f64::consts::SQRT_2; 
}
